<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank API Tester</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .endpoint-card {
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
        }
        .response-area {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            min-height: 100px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="mb-4">Bank API Tester</h1>

        <!-- User Endpoints -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3>User Management</h3>
            </div>
            <div class="card-body">
                <!-- Register User -->
                <div class="endpoint-card">
                    <h5>Register User</h5>
                    <div class="mb-3">
                        <input type="text" id="username" class="form-control mb-2" placeholder="Username">
                        <input type="email" id="email" class="form-control mb-2" placeholder="Email">
                        <input type="password" id="password" class="form-control mb-2" placeholder="Password">
                        <input type="text" id="phoneNumber" class="form-control mb-2" placeholder="Phone Number">
                        <button class="btn btn-primary" onclick="registerUser()">Register</button>
                    </div>
                    <div class="response-area" id="registerResponse"></div>
                </div>

                <!-- Update Username -->
                <div class="endpoint-card">
                    <h5>Update Username</h5>
                    <div class="mb-3">
                        <input type="text" id="updateUsernameOld" class="form-control mb-2" placeholder="Current Username">
                        <input type="text" id="updateUsernameNew" class="form-control mb-2" placeholder="New Username">
                        <button class="btn btn-warning" onclick="updateUsername()">Update Username</button>
                    </div>
                    <div class="response-area" id="updateUsernameResponse"></div>
                </div>
            </div>
        </div>

        <!-- Account Endpoints -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h3>Account Management</h3>
            </div>
            <div class="card-body">
                <!-- Create Account -->
                <div class="endpoint-card">
                    <h5>Create Account</h5>
                    <div class="mb-3">
                        <input type="text" id="accountUsername" class="form-control mb-2" placeholder="Username">
                        <input type="number" id="initialBalance" class="form-control mb-2" placeholder="Initial Balance">
                        <button class="btn btn-success" onclick="createAccount()">Create Account</button>
                    </div>
                    <div class="response-area" id="createAccountResponse"></div>
                </div>

                <!-- Get All Accounts -->
                <div class="endpoint-card">
                    <h5>Get All Accounts</h5>
                    <button class="btn btn-info" onclick="getAllAccounts()">Get All Accounts</button>
                    <div class="response-area" id="allAccountsResponse"></div>
                </div>
            </div>
        </div>

        <!-- Transaction Endpoints -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3>Transactions</h3>
            </div>
            <div class="card-body">
                <!-- Transfer Money -->
                <div class="endpoint-card">
                    <h5>Transfer Money</h5>
                    <div class="mb-3">
                        <input type="text" id="fromAccount" class="form-control mb-2" placeholder="From Account Number">
                        <input type="text" id="toAccount" class="form-control mb-2" placeholder="To Account Number">
                        <input type="number" id="amount" class="form-control mb-2" placeholder="Amount">
                        <button class="btn btn-primary" onclick="transferMoney()">Transfer</button>
                    </div>
                    <div class="response-area" id="transferResponse"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8080/api';

        // Helper function to display responses
        function displayResponse(elementId, data) {
            const responseElement = document.getElementById(elementId);
            responseElement.textContent = JSON.stringify(data, null, 2);
        }

        // User Endpoints
        async function registerUser() {
            const userData = {
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                phoneNumber: document.getElementById('phoneNumber').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/user/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });
                const data = await response.json();
                displayResponse('registerResponse', data);
            } catch (error) {
                displayResponse('registerResponse', { error: error.message });
            }
        }

        async function updateUsername() {
            const updateData = {
                oldUsername: document.getElementById('updateUsernameOld').value,
                newUsername: document.getElementById('updateUsernameNew').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/user/update/Username`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updateData)
                });
                const data = await response.json();
                displayResponse('updateUsernameResponse', data);
            } catch (error) {
                displayResponse('updateUsernameResponse', { error: error.message });
            }
        }

        // Account Endpoints
        async function createAccount() {
            const accountData = {
                username: document.getElementById('accountUsername').value,
                initialBalance: document.getElementById('initialBalance').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/accounts/create`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(accountData)
                });
                const data = await response.json();
                displayResponse('createAccountResponse', data);
            } catch (error) {
                displayResponse('createAccountResponse', { error: error.message });
            }
        }

        async function getAllAccounts() {
            try {
                const response = await fetch(`${API_BASE_URL}/accounts/get/all_accounts`);
                const data = await response.json();
                displayResponse('allAccountsResponse', data);
            } catch (error) {
                displayResponse('allAccountsResponse', { error: error.message });
            }
        }

        // Transaction Endpoints
        async function transferMoney() {
            const transferData = {
                fromAccountNumber: document.getElementById('fromAccount').value,
                toAccountNumber: document.getElementById('toAccount').value,
                amount: document.getElementById('amount').value
            };

            try {
                const response = await fetch(`${API_BASE_URL}/transactions/transferMoney`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(transferData)
                });
                const data = await response.json();
                displayResponse('transferResponse', data);
            } catch (error) {
                displayResponse('transferResponse', { error: error.message });
            }
        }
    </script>
</body>
</html>
